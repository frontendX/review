# 域名发散与域名收敛

### 域名发散

PC 时代为了突破浏览器的域名并发限制，遵循这样一条定律：
>  http 静态资源采用多个子域名

这么做是充分利用现代浏览器的多线程并发下载能力。
由于浏览器的限制，每个浏览器，允许对每个域名的连接数一般是有上限的，如图：
![各浏览器的并行连接数](https://upload-images.jianshu.io/upload_images/1726248-4492744d84e569ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

从图中可以看出，Chrome与Firefox等浏览器每个 `hostname` 的最大连接数基本都是6个，IE 会比它们高一点，总体而言并发数不高。
所以 PC 时代对静态资源优化时，通常将静态资源分布在几个不同域，保证资源最完美地分域名存储，以提供最大并行度，让客户端加载静态资源更为迅速。

**注：为什么浏览器要做并发限制呢？**
1、以前，服务器的负载能力差，稍微流量大一点服务器就容易就崩溃。 所以为了保护服务器不被强暴到崩溃，浏览器要对 `max connections`（最大并发数）进行限制。如果每个用户的最大并发数不限制的话，服务器的负载能力会大幅下降。
2、另外还有一个方面就是, 防止 DDOS 攻击。最基本的 DoS 攻击就是利用合理的服务请求来占用过多的服务资源，从而使合法用户无法得到服务的响应。

### 域名收敛
域名收敛的意思就是建议将静态资源只放在一个域名下面，而非发散情况下的多个域名下。上面也说到了，域名发散可以突破浏览器的域名并发限制，域名发散是 PC 时代的产物，而现在进入移动互联网时代，通过无线设备访问网站，App的用户已占据了很大一部分比重，而域名收敛正是在这种情况下提出的。且听我一步步分析。
域名收敛可以解决DNS解析耗时问题，缺点是浏览器的最大连接数限制，需排队加载，影响效率。
